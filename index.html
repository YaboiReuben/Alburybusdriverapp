<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Albury and Wodonga Transport - Bus Driver Application</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            max-width: 800px;
            width: 100%;
            padding: 2.5rem; /* Increased padding */
            transition: all 0.3s ease-in-out;
        }
        .form-step {
            display: none;
        }
        .form-step.active {
            display: block;
        }
        .btn-primary {
            background-color: #4f46e5; /* Indigo 600 */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; /* Rounded */
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
        }
        .btn-primary:hover {
            background-color: #4338ca; /* Indigo 700 */
            transform: translateY(-1px);
        }
        .btn-primary:active {
            transform: translateY(0);
        }
        .btn-secondary {
            background-color: #e0e7ff; /* Indigo 100 */
            color: #4f46e5; /* Indigo 600 */
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; /* Rounded */
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
        }
        .btn-secondary:hover {
            background-color: #c7d2fe; /* Indigo 200 */
            transform: translateY(-1px);
        }
        .btn-secondary:active {
            transform: translateY(0);
        }
        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db; /* Gray 300 */
            border-radius: 0.5rem; /* Rounded */
            font-size: 1rem;
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #6366f1; /* Indigo 500 */
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.25); /* Indigo 500 with opacity */
        }
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        .label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #374151; /* Gray 700 */
        }
        .error-message {
            color: #ef4444; /* Red 500 */
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }
        /* Message box for alerts */
        .message-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 1000;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 1px solid #d1d5db;
        }
        .message-box-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Requirements Screen -->
        <div id="requirements-screen" class="text-center">
            <h1 class="text-3xl font-bold text-gray-900 mb-6">Albury and Wodonga Transport</h1>
            <h2 class="text-2xl font-semibold text-gray-800 mb-8">Bus Driver Application Requirements</h2>
            <ul class="list-disc list-inside text-left text-lg text-gray-700 space-y-3 mb-10 max-w-md mx-auto">
                <li>You must be at least 13 years of age.</li>
                <li>You must be a member of our official Discord server.</li>
                <li>Any use of AI to generate responses will result in an automatic disqualification.</li>
            </ul>
            <button id="start-application-btn" class="btn-primary">Start Application</button>
        </div>

        <!-- Application Form -->
        <form id="application-form" class="form-step">
            <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Bus Driver Application Form</h2>
            <div id="form-steps-container">
                <!-- Step 1: Roblox Username -->
                <div id="step-1" class="form-step active">
                    <label for="roblox-username" class="label">Your Roblox Username:</label>
                    <input type="text" id="roblox-username" name="robloxUsername" required class="mb-4">
                    <div class="flex justify-end">
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 2: Discord Username -->
                <div id="step-2" class="form-step">
                    <label for="discord-username" class="label">Your Discord Username (e.g., YourName#1234):</label>
                    <input type="text" id="discord-username" name="discordUsername" required class="mb-4">
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 3: Age -->
                <div id="step-3" class="form-step">
                    <label for="age" class="label">Your Age:</label>
                    <input type="number" id="age" name="age" min="13" required class="mb-4">
                    <p id="age-error" class="error-message hidden">You must be at least 13 years old.</p>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 4: Why do you want to be a bus driver? -->
                <div id="step-4" class="form-step">
                    <label for="why-bus-driver" class="label">Why do you want to be a bus driver for Albury and Wodonga Transport?:</label>
                    <textarea id="why-bus-driver" name="whyBusDriver" required class="mb-4"></textarea>
                    <!-- Removed word count display -->
                    <p id="why-bus-driver-error" class="error-message hidden">This field is required.</p>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 5: Availability - Preferred Day(s) -->
                <div id="step-5" class="form-step">
                    <label for="preferred-day" class="label">Preferred Day(s):</label>
                    <select id="preferred-day" name="preferredDay" required class="mb-4">
                        <option value="">Select Day(s)</option>
                        <option value="Monday">Monday</option>
                        <option value="Tuesday">Tuesday</option>
                        <option value="Wednesday">Wednesday</option>
                        <option value="Thursday">Thursday</option>
                        <option value="Friday">Friday</option>
                        <option value="Saturday">Saturday</option>
                        <option value="Sunday">Sunday</option>
                        <option value="Weekdays">Weekdays</option>
                        <option value="Weekends">Weekends</option>
                        <option value="Any Day">Any Day</option>
                        <option value="Specific Days (Explain below)">Specific Days (Explain below)</option>
                    </select>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 6: Availability - Preferred Time Slot -->
                <div id="step-6" class="form-step">
                    <label for="preferred-time" class="label">Preferred Time Slot:</label>
                    <select id="preferred-time" name="preferredTime" required class="mb-4">
                        <option value="">Select Time</option>
                        <option value="Morning (AEST)">Morning (AEST)</option>
                        <option value="Afternoon (AEST)">Afternoon (AEST)</option>
                        <option value="Evening (AEST)">Evening (AEST)</option>
                        <option value="Any Time">Any Time</option>
                    </select>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 7: Availability - Specific Notes -->
                <div id="step-7" class="form-step">
                    <label for="availability-notes" class="label">Any specific notes on your availability (e.g., specific days/hours, holidays):</label>
                    <textarea id="availability-notes" name="availabilityNotes" class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 8: Handling Situations - Hacker -->
                <div id="step-8" class="form-step">
                    <label for="handle-hacker" class="label">How would you handle a hacker disrupting your bus route or the game?</label>
                    <textarea id="handle-hacker" name="handleHacker" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 9: Handling Situations - Troller -->
                <div id="step-9" class="form-step">
                    <label for="handle-troller" class="label">How would you handle a troller intentionally causing chaos or blocking the bus?</label>
                    <textarea id="handle-troller" name="handleTroller" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 10: Handling Situations - Rude Passenger -->
                <div id="step-10" class="form-step">
                    <label for="handle-rude-passenger" class="label">How would you handle a passenger being rude or disrespectful to you or other players?</label>
                    <textarea id="handle-rude-passenger" name="handleRudePassenger" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 11: Roblox Driving Experience -->
                <div id="step-11" class="form-step">
                    <label for="roblox-driving-experience" class="label">Do you have any experience driving in Roblox games (e.g., driving simulators, roleplay games)? If so, please describe:</label>
                    <textarea id="roblox-driving-experience" name="robloxDrivingExperience" class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 12: Disruptive Passenger -->
                <div id="step-12" class="form-step">
                    <label for="handle-disruptive-passenger" class="label">How would you handle a disruptive or uncooperative passenger on your bus?</label>
                    <textarea id="handle-disruptive-passenger" name="handleDisruptivePassenger" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 13: Bus Breakdown -->
                <div id="step-13" class="form-step">
                    <label for="bus-breakdown" class="label">What would you do if your bus broke down during a route with passengers on board?</label>
                    <textarea id="bus-breakdown" name="busBreakdown" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 14: Roblox ToS and Community Guidelines -->
                <div id="step-14" class="form-step">
                    <label for="roblox-tos" class="label">Are you familiar with Roblox's Terms of Service and Community Guidelines? How important are they for a bus driver?</label>
                    <textarea id="roblox-tos" name="robloxTos" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 15: Commitment Frequency -->
                <div id="step-15" class="form-step">
                    <label for="commitment-frequency" class="label">How often can you commit to driving buses for our group (e.g., daily, a few times a week, weekly)?</label>
                    <textarea id="commitment-frequency" name="commitmentFrequency" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 16: Qualities of a Good Bus Driver -->
                <div id="step-16" class="form-step">
                    <label for="good-bus-driver-qualities" class="label">What qualities do you think a good bus driver should possess?</label>
                    <textarea id="good-bus-driver-qualities" name="goodBusDriverQualities" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 17: Problem Solving -->
                <div id="step-17" class="form-step">
                    <label for="problem-solving" class="label">Describe a time you had to solve a problem, either in a game or in real life. How did you approach it?</label>
                    <textarea id="problem-solving" name="problemSolving" required class="mb-4"></textarea>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="button" class="btn-primary next-btn">Next</button>
                    </div>
                </div>

                <!-- Step 18: Discord Server Confirmation -->
                <div id="step-18" class="form-step">
                    <div class="flex items-center mb-4">
                        <input type="checkbox" id="discord-confirm" name="discordConfirm" class="mr-2 h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
                        <label for="discord-confirm" class="label mb-0">I confirm I am a member of the "Albury and Wodonga Transport" Discord server.</label>
                    </div>
                    <p id="discord-confirm-error" class="error-message hidden">You must confirm your Discord membership.</p>
                    <div class="flex justify-between">
                        <button type="button" class="btn-secondary prev-btn">Previous</button>
                        <button type="submit" class="btn-primary">Submit Application</button>
                    </div>
                </div>
            </div>
            <!-- Progress Bar (Optional, but good for UX) -->
            <div class="w-full bg-gray-200 rounded-full h-2.5 mt-8">
                <div id="progress-bar" class="bg-indigo-600 h-2.5 rounded-full" style="width: 0%;"></div>
            </div>
        </form>

        <!-- Thank You Screen -->
        <div id="thank-you-screen" class="form-step text-center">
            <h2 class="text-3xl font-bold text-gray-900 mb-6">Thank You for Your Application!</h2>
            <p class="text-lg text-gray-700 mb-8">Your application has been submitted successfully. We will review it and get back to you shortly.</p>
            <p class="text-md text-gray-600">Please keep an eye on our Discord server for updates.</p>
        </div>

        <!-- Message Box for alerts -->
        <div id="message-box-overlay" class="message-box-overlay hidden"></div>
        <div id="message-box" class="message-box hidden">
            <p id="message-box-text" class="text-lg text-gray-800 mb-6"></p>
            <button id="message-box-ok-btn" class="btn-primary">OK</button>
        </div>
    </div>

    <script>
        const requirementsScreen = document.getElementById('requirements-screen');
        const startApplicationBtn = document.getElementById('start-application-btn');
        const applicationForm = document.getElementById('application-form');
        const thankYouScreen = document.getElementById('thank-you-screen');
        const formSteps = Array.from(document.querySelectorAll('.form-step:not(#application-form):not(#thank-you-screen)')); // Exclude main form and thank you screen
        const progressBar = document.getElementById('progress-bar');
        const messageBox = document.getElementById('message-box');
        const messageBoxOverlay = document.getElementById('message-box-overlay');
        const messageBoxText = document.getElementById('message-box-text');
        const messageBoxOkBtn = document.getElementById('message-box-ok-btn');

        let currentStep = 0;
        const totalSteps = formSteps.length;

        // Discord Webhook URL - REPLACE THIS WITH YOUR ACTUAL WEBHOOK URL
        const DISCORD_WEBHOOK_URL = 'https://discord.com/api/webhooks/1398532071642894376/2GhPJl_ypmC_3xxkBF3VQMBlRQqf2rSZgOdAQTj6wX_lzdyDoYoC_8MpqbwvXWm-9lKc';

        // Load saved data from localStorage
        const savedFormData = JSON.parse(localStorage.getItem('busDriverFormData')) || {};

        function showMessageBox(message) {
            messageBoxText.textContent = message;
            messageBox.classList.remove('hidden');
            messageBoxOverlay.classList.remove('hidden');
        }

        function hideMessageBox() {
            messageBox.classList.add('hidden');
            messageBoxOverlay.classList.add('hidden');
        }

        messageBoxOkBtn.addEventListener('click', hideMessageBox);

        function saveFormData() {
            const formData = {};
            formSteps.forEach(step => {
                const inputs = step.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    if (input.type === 'checkbox') {
                        formData[input.name] = input.checked;
                    } else {
                        formData[input.name] = input.value;
                    }
                });
            });
            localStorage.setItem('busDriverFormData', JSON.stringify(formData));
        }

        function loadFormData() {
            for (const key in savedFormData) {
                const input = document.querySelector(`[name="${key}"]`);
                if (input) {
                    if (input.type === 'checkbox') {
                        input.checked = savedFormData[key];
                    } else {
                        input.value = savedFormData[key];
                    }
                }
            }
            // Removed word count update for the essay question
        }

        function showStep(stepIndex) {
            formSteps.forEach((step, index) => {
                if (index === stepIndex) {
                    step.classList.add('active');
                } else {
                    step.classList.remove('active');
                }
            });
            updateProgressBar();
            // Scroll to top of the form for better UX on navigation
            applicationForm.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function updateProgressBar() {
            const progress = ((currentStep + 1) / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;
        }

        function validateStep(stepIndex) {
            let isValid = true;
            const currentStepElement = formSteps[stepIndex];
            const inputs = currentStepElement.querySelectorAll('input[required], textarea[required], select[required]');

            inputs.forEach(input => {
                if (input.type === 'checkbox') {
                    if (!input.checked) {
                        isValid = false;
                        document.getElementById(`${input.id}-error`).classList.remove('hidden');
                    } else {
                        document.getElementById(`${input.id}-error`).classList.add('hidden');
                    }
                } else if (!input.value.trim()) {
                    isValid = false;
                    input.style.borderColor = '#ef4444'; // Red border
                    // Update error message for "Why do you want to be a bus driver?" to be general
                    if (input.id === 'why-bus-driver') {
                        document.getElementById('why-bus-driver-error').textContent = 'This field is required.';
                    }
                } else {
                    input.style.borderColor = '#d1d5db'; // Default border
                    if (input.id === 'why-bus-driver') {
                        document.getElementById('why-bus-driver-error').classList.add('hidden');
                    }
                }
            });

            // Specific validations
            if (stepIndex === 2) { // Age validation
                const ageInput = document.getElementById('age');
                const ageError = document.getElementById('age-error');
                if (parseInt(ageInput.value) < 13) {
                    isValid = false;
                    ageError.classList.remove('hidden');
                    ageInput.style.borderColor = '#ef4444';
                } else {
                    ageError.classList.add('hidden');
                    ageInput.style.borderColor = '#d1d5db';
                }
            }

            // Removed word count validation for step 3 (now step 4)
            // if (stepIndex === 3) { // Why bus driver word count validation
            //     const whyBusDriverTextarea = document.getElementById('why-bus-driver');
            //     const wordCount = whyBusDriverTextarea.value.trim().split(/\s+/).filter(word => word.length > 0).length;
            //     const whyBusDriverError = document.getElementById('why-bus-driver-error');
            //     if (wordCount < 50) {
            //         isValid = false;
            //         whyBusDriverError.classList.remove('hidden');
            //         whyBusDriverTextarea.style.borderColor = '#ef4444';
            //     } else {
            //         whyBusDriverError.classList.add('hidden');
            //         whyBusDriverTextarea.style.borderColor = '#d1d5db';
            //     }
            // }

            return isValid;
        }

        // Removed updateWordCount function
        // function updateWordCount(textarea) {
        //     const words = textarea.value.trim().split(/\s+/).filter(word => word.length > 0).length;
        //     const wordCountDisplay = document.getElementById(`${textarea.id}-word-count`);
        //     if (wordCountDisplay) {
        //         wordCountDisplay.textContent = `Word count: ${words}`;
        //     }
        // }

        // Event Listeners
        startApplicationBtn.addEventListener('click', () => {
            requirementsScreen.classList.add('hidden');
            applicationForm.classList.remove('form-step'); // Remove display:none
            applicationForm.classList.add('active'); // Show form
            showStep(currentStep);
            loadFormData(); // Load data when form starts
        });

        document.querySelectorAll('.next-btn').forEach(button => {
            button.addEventListener('click', () => {
                if (validateStep(currentStep)) {
                    saveFormData(); // Save data before moving
                    currentStep++;
                    if (currentStep < totalSteps) {
                        showStep(currentStep);
                    }
                }
            });
        });

        document.querySelectorAll('.prev-btn').forEach(button => {
            button.addEventListener('click', () => {
                saveFormData(); // Save data before moving back
                currentStep--;
                if (currentStep >= 0) {
                    showStep(currentStep);
                }
            });
        });

        document.getElementById('application-form').addEventListener('submit', async (event) => {
            event.preventDefault();
            if (validateStep(currentStep)) {
                saveFormData(); // Final save

                const formData = new FormData(event.target);
                const data = {};
                for (let [key, value] of formData.entries()) {
                    data[key] = value;
                }
                data['discordConfirm'] = document.getElementById('discord-confirm').checked; // Ensure checkbox state is captured

                console.log('Application Data:', data); // Log data to console for debugging

                // Prepare data for Discord webhook
                let discordMessageContent = "New Bus Driver Application Received!\n\n";
                discordMessageContent += `**Roblox Username:** ${data.robloxUsername}\n`;
                discordMessageContent += `**Discord Username:** ${data.discordUsername}\n`;
                discordMessageContent += `**Age:** ${data.age}\n\n`;
                discordMessageContent += `**Why do you want to be a bus driver?**\n${data.whyBusDriver}\n\n`;
                discordMessageContent += `**Availability:**\n`;
                discordMessageContent += `  - **Preferred Day(s):** ${data.preferredDay}\n`;
                discordMessageContent += `  - **Preferred Time Slot:** ${data.preferredTime}\n`;
                if (data.availabilityNotes) {
                    discordMessageContent += `  - **Specific Notes:** ${data.availabilityNotes}\n\n`;
                } else {
                    discordMessageContent += `\n`;
                }
                discordMessageContent += `**How would you handle the following situations?**\n`;
                discordMessageContent += `  - **Hacker:** ${data.handleHacker}\n`;
                discordMessageContent += `  - **Troller:** ${data.handleTroller}\n`;
                discordMessageContent += `  - **Rude Passenger:** ${data.handleRudePassenger}\n\n`;
                discordMessageContent += `**Roblox Driving Experience:** ${data.robloxDrivingExperience || 'N/A'}\n`;
                discordMessageContent += `**Disruptive Passenger Handling:** ${data.handleDisruptivePassenger}\n`;
                discordMessageContent += `**Bus Breakdown Handling:** ${data.busBreakdown}\n`;
                discordMessageContent += `**Roblox ToS & Community Guidelines:** ${data.robloxTos}\n`;
                discordMessageContent += `**Commitment Frequency:** ${data.commitmentFrequency}\n`;
                discordMessageContent += `**Qualities of a Good Bus Driver:** ${data.goodBusDriverQualities}\n`;
                discordMessageContent += `**Problem Solving:** ${data.problemSolving}\n`;
                discordMessageContent += `**Discord Server Confirmed:** ${data.discordConfirm ? 'Yes' : 'No'}\n`;


                try {
                    const response = await fetch(DISCORD_WEBHOOK_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ content: discordMessageContent }),
                    });

                    if (response.ok) {
                        console.log('Application successfully sent to Discord!');
                        // Clear saved data after successful submission
                        localStorage.removeItem('busDriverFormData');

                        applicationForm.classList.remove('active');
                        applicationForm.classList.add('form-step'); // Hide form
                        thankYouScreen.classList.add('active'); // Show thank you screen
                    } else {
                        console.error('Failed to send application to Discord:', response.status, response.statusText);
                        showMessageBox('Failed to submit application. Please try again later. (Error: ' + response.status + ')');
                    }
                } catch (error) {
                    console.error('Error sending application to Discord:', error);
                    showMessageBox('An error occurred while submitting your application. Please check your internet connection and try again.');
                }
            }
        });

        // Removed word count listener for the essay question
        // const whyBusDriverTextarea = document.getElementById('why-bus-driver');
        // if (whyBusDriverTextarea) {
        //     whyBusDriverTextarea.addEventListener('input', () => updateWordCount(whyBusDriverTextarea));
        // }

        // Initial setup: hide form and thank you screen
        applicationForm.classList.add('form-step');
        thankYouScreen.classList.add('form-step');
        requirementsScreen.classList.remove('hidden'); // Ensure requirements screen is visible initially

    </script>
</body>
</html>
